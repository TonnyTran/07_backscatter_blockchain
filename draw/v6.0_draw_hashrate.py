import matplotlib.pyplot as plt
from xlrd import open_workbook
import xlsxwriter
import numpy as np

file_name = '../result_draw/v6.0_hashrate_throughtput.xlsx'
workbook = xlsxwriter.Workbook(file_name)
worksheet = workbook.add_worksheet()
X = [0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20]
column = 2

book0 = open_workbook('../results/result_v6_00.xls')
book1 = open_workbook('../results/result_v6_02.xls')
book2 = open_workbook('../results/result_v6_04.xls')
book3 = open_workbook('../results/result_v6_06.xls')
book4 = open_workbook('../results/result_v6_08.xls')
book5 = open_workbook('../results/result_v6_10.xls')
book6 = open_workbook('../results/result_v6_12.xls')
book7 = open_workbook('../results/result_v6_14.xls')
book8 = open_workbook('../results/result_v6_16.xls')
book9 = open_workbook('../results/result_v6_18.xls')
book10 = open_workbook('../results/result_v6_20.xls')

sheet0 = book1.sheet_by_index(0)
sheet1 = book1.sheet_by_index(0)
sheet2 = book2.sheet_by_index(0)
sheet3 = book3.sheet_by_index(0)
sheet4 = book4.sheet_by_index(0)
sheet5 = book5.sheet_by_index(0)
sheet6 = book6.sheet_by_index(0)
sheet7 = book7.sheet_by_index(0)
sheet8 = book8.sheet_by_index(0)
sheet9 = book9.sheet_by_index(0)
sheet10 = book10.sheet_by_index(0)

Y1miner = []
Y10, Y11, Y12, Y13, Y14, Y15, Y16, Y17, Y18, Y19, Y110 = [], [], [], [], [], [], [], [], [], [], []
for row_index in xrange(7000, 9000):
    Y10.append(float(sheet0.cell_value(row_index, column)))
    Y11.append(float(sheet1.cell_value(row_index, column)))
    Y12.append(float(sheet2.cell_value(row_index, column)))
    Y13.append(float(sheet3.cell_value(row_index, column)))
    Y14.append(float(sheet4.cell_value(row_index, column)))
    Y15.append(float(sheet5.cell_value(row_index, column)))
    Y16.append(float(sheet6.cell_value(row_index, column)))
    Y17.append(float(sheet7.cell_value(row_index, column)))
    Y18.append(float(sheet8.cell_value(row_index, column)))
    Y19.append(float(sheet9.cell_value(row_index, column)))
    Y110.append(float(sheet10.cell_value(row_index, column)))

Y1miner.append(np.mean(Y10)/200)
Y1miner.append(np.mean(Y11)/200)
Y1miner.append(np.mean(Y12)/200)
Y1miner.append(np.mean(Y13)/200)
Y1miner.append(np.mean(Y14)/200)
Y1miner.append(np.mean(Y15)/200)
Y1miner.append(np.mean(Y16)/200)
Y1miner.append(np.mean(Y17)/200)
Y1miner.append(np.mean(Y18)/200)
Y1miner.append(np.mean(Y19)/200)
Y1miner.append(np.mean(Y110)/200)

worksheet.write(1, 0, str(Y1miner[0]))
worksheet.write(2, 0, str(Y1miner[1]))
worksheet.write(3, 0, str(Y1miner[2]))
worksheet.write(4, 0, str(Y1miner[3]))
worksheet.write(5, 0, str(Y1miner[4]))
worksheet.write(6, 0, str(Y1miner[5]))
worksheet.write(7, 0, str(Y1miner[6]))
worksheet.write(8, 0, str(Y1miner[7]))
worksheet.write(9, 0, str(Y1miner[8]))
worksheet.write(10, 0, str(Y1miner[9]))
worksheet.write(11, 0, str(Y1miner[10]))

print(Y1miner)

book20 = open_workbook('../results/result_rand_v6_00.xls')
book21 = open_workbook('../results/result_rand_v6_02.xls')
book22 = open_workbook('../results/result_rand_v6_04.xls')
book23 = open_workbook('../results/result_rand_v6_06.xls')
book24 = open_workbook('../results/result_rand_v6_08.xls')
book25 = open_workbook('../results/result_rand_v6_10.xls')
book26 = open_workbook('../results/result_rand_v6_12.xls')
book27 = open_workbook('../results/result_rand_v6_14.xls')
book28 = open_workbook('../results/result_rand_v6_16.xls')
book29 = open_workbook('../results/result_rand_v6_18.xls')
book210 = open_workbook('../results/result_rand_v6_20.xls')

sheet20 = book20.sheet_by_index(0)
sheet21 = book21.sheet_by_index(0)
sheet22 = book22.sheet_by_index(0)
sheet23 = book23.sheet_by_index(0)
sheet24 = book24.sheet_by_index(0)
sheet25 = book25.sheet_by_index(0)
sheet26 = book26.sheet_by_index(0)
sheet27 = book27.sheet_by_index(0)
sheet28 = book28.sheet_by_index(0)
sheet29 = book29.sheet_by_index(0)
sheet210 = book210.sheet_by_index(0)

Y2miner = []
Y20, Y21, Y22, Y23, Y24, Y25, Y26, Y27, Y28, Y29, Y210 = [], [], [], [], [], [], [], [], [], [], []
for row_index in xrange(100, 400):
    Y20.append(float(sheet20.cell_value(row_index, column)))
    Y21.append(float(sheet21.cell_value(row_index, column)))
    Y22.append(float(sheet22.cell_value(row_index, column)))
    Y23.append(float(sheet23.cell_value(row_index, column)))
    Y24.append(float(sheet24.cell_value(row_index, column)))
    Y25.append(float(sheet25.cell_value(row_index, column)))
    Y26.append(float(sheet26.cell_value(row_index, column)))
    Y27.append(float(sheet27.cell_value(row_index, column)))
    Y28.append(float(sheet28.cell_value(row_index, column)))
    Y29.append(float(sheet29.cell_value(row_index, column)))
    Y210.append(float(sheet210.cell_value(row_index, column)))

Y2miner.append(np.mean(Y20)/200)
Y2miner.append(np.mean(Y21)/200)
Y2miner.append(np.mean(Y22)/200)
Y2miner.append(np.mean(Y23)/200)
Y2miner.append(np.mean(Y24)/200)
Y2miner.append(np.mean(Y25)/200)
Y2miner.append(np.mean(Y26)/200)
Y2miner.append(np.mean(Y27)/200)
Y2miner.append(np.mean(Y28)/200)
Y2miner.append(np.mean(Y29)/200)
Y2miner.append(np.mean(Y210)/200)

worksheet.write(1, 1, str(Y2miner[0]))
worksheet.write(2, 1, str(Y2miner[1]))
worksheet.write(3, 1, str(Y2miner[2]))
worksheet.write(4, 1, str(Y2miner[3]))
worksheet.write(5, 1, str(Y2miner[4]))
worksheet.write(6, 1, str(Y2miner[5]))
worksheet.write(7, 1, str(Y2miner[6]))
worksheet.write(8, 1, str(Y2miner[7]))
worksheet.write(9, 1, str(Y2miner[8]))
worksheet.write(10, 1, str(Y2miner[9]))
worksheet.write(11, 1, str(Y2miner[10]))

print(Y2miner)

book30 = open_workbook('../results/result_htt_v6_00.xls')
book31 = open_workbook('../results/result_htt_v6_02.xls')
book32 = open_workbook('../results/result_htt_v6_04.xls')
book33 = open_workbook('../results/result_htt_v6_06.xls')
book34 = open_workbook('../results/result_htt_v6_08.xls')
book35 = open_workbook('../results/result_htt_v6_10.xls')
book36 = open_workbook('../results/result_htt_v6_12.xls')
book37 = open_workbook('../results/result_htt_v6_14.xls')
book38 = open_workbook('../results/result_htt_v6_16.xls')
book39 = open_workbook('../results/result_htt_v6_18.xls')
book310 = open_workbook('../results/result_htt_v6_20.xls')

sheet30 = book30.sheet_by_index(0)
sheet31 = book31.sheet_by_index(0)
sheet32 = book32.sheet_by_index(0)
sheet33 = book33.sheet_by_index(0)
sheet34 = book34.sheet_by_index(0)
sheet35 = book35.sheet_by_index(0)
sheet36 = book36.sheet_by_index(0)
sheet37 = book37.sheet_by_index(0)
sheet38 = book38.sheet_by_index(0)
sheet39 = book39.sheet_by_index(0)
sheet310 = book310.sheet_by_index(0)

Y3miner = []
Y30, Y31, Y32, Y33, Y34, Y35, Y36, Y37, Y38, Y39, Y310 = [], [], [], [], [], [], [], [], [], [], []
for row_index in xrange(100, 400):
    Y30.append(float(sheet30.cell_value(row_index, column)))
    Y31.append(float(sheet31.cell_value(row_index, column)))
    Y32.append(float(sheet32.cell_value(row_index, column)))
    Y33.append(float(sheet33.cell_value(row_index, column)))
    Y34.append(float(sheet34.cell_value(row_index, column)))
    Y35.append(float(sheet35.cell_value(row_index, column)))
    Y36.append(float(sheet36.cell_value(row_index, column)))
    Y37.append(float(sheet37.cell_value(row_index, column)))
    Y38.append(float(sheet38.cell_value(row_index, column)))
    Y39.append(float(sheet39.cell_value(row_index, column)))
    Y310.append(float(sheet310.cell_value(row_index, column)))

Y3miner.append(np.mean(Y30)/200)
Y3miner.append(np.mean(Y31)/200)
Y3miner.append(np.mean(Y32)/200)
Y3miner.append(np.mean(Y33)/200)
Y3miner.append(np.mean(Y34)/200)
Y3miner.append(np.mean(Y35)/200)
Y3miner.append(np.mean(Y36)/200)
Y3miner.append(np.mean(Y37)/200)
Y3miner.append(np.mean(Y38)/200)
Y3miner.append(np.mean(Y39)/200)
Y3miner.append(np.mean(Y310)/200)

worksheet.write(1, 2, str(Y3miner[0]))
worksheet.write(2, 2, str(Y3miner[1]))
worksheet.write(3, 2, str(Y3miner[2]))
worksheet.write(4, 2, str(Y3miner[3]))
worksheet.write(5, 2, str(Y3miner[4]))
worksheet.write(6, 2, str(Y3miner[5]))
worksheet.write(7, 2, str(Y3miner[6]))
worksheet.write(8, 2, str(Y3miner[7]))
worksheet.write(9, 2, str(Y3miner[8]))
worksheet.write(10, 2, str(Y3miner[9]))
worksheet.write(11, 2, str(Y3miner[10]))

print(Y3miner)

book40 = open_workbook('../results/result_bc_v6_00.xls')
book41 = open_workbook('../results/result_bc_v6_02.xls')
book42 = open_workbook('../results/result_bc_v6_04.xls')
book43 = open_workbook('../results/result_bc_v6_06.xls')
book44 = open_workbook('../results/result_bc_v6_08.xls')
book45 = open_workbook('../results/result_bc_v6_10.xls')
book46 = open_workbook('../results/result_bc_v6_12.xls')
book47 = open_workbook('../results/result_bc_v6_14.xls')
book48 = open_workbook('../results/result_bc_v6_16.xls')
book49 = open_workbook('../results/result_bc_v6_18.xls')
book410 = open_workbook('../results/result_bc_v6_20.xls')

sheet40 = book40.sheet_by_index(0)
sheet41 = book41.sheet_by_index(0)
sheet42 = book42.sheet_by_index(0)
sheet43 = book43.sheet_by_index(0)
sheet44 = book44.sheet_by_index(0)
sheet45 = book45.sheet_by_index(0)
sheet46 = book46.sheet_by_index(0)
sheet47 = book47.sheet_by_index(0)
sheet48 = book48.sheet_by_index(0)
sheet49 = book49.sheet_by_index(0)
sheet410 = book410.sheet_by_index(0)

Y4miner = []
Y40, Y41, Y42, Y43, Y44, Y45, Y46, Y47, Y48, Y49, Y410 = [], [], [], [], [], [], [], [], [], [], []
for row_index in xrange(100, 400):
    Y40.append(float(sheet40.cell_value(row_index, column)))
    Y41.append(float(sheet41.cell_value(row_index, column)))
    Y42.append(float(sheet42.cell_value(row_index, column)))
    Y43.append(float(sheet43.cell_value(row_index, column)))
    Y44.append(float(sheet44.cell_value(row_index, column)))
    Y45.append(float(sheet45.cell_value(row_index, column)))
    Y46.append(float(sheet46.cell_value(row_index, column)))
    Y47.append(float(sheet47.cell_value(row_index, column)))
    Y48.append(float(sheet48.cell_value(row_index, column)))
    Y49.append(float(sheet49.cell_value(row_index, column)))
    Y410.append(float(sheet410.cell_value(row_index, column)))

Y4miner.append(np.mean(Y40)/200)
Y4miner.append(np.mean(Y41)/200)
Y4miner.append(np.mean(Y42)/200)
Y4miner.append(np.mean(Y43)/200)
Y4miner.append(np.mean(Y44)/200)
Y4miner.append(np.mean(Y45)/200)
Y4miner.append(np.mean(Y46)/200)
Y4miner.append(np.mean(Y47)/200)
Y4miner.append(np.mean(Y48)/200)
Y4miner.append(np.mean(Y49)/200)
Y4miner.append(np.mean(Y410)/200)

worksheet.write(1, 3, str(Y4miner[0]))
worksheet.write(2, 3, str(Y4miner[1]))
worksheet.write(3, 3, str(Y4miner[2]))
worksheet.write(4, 3, str(Y4miner[3]))
worksheet.write(5, 3, str(Y4miner[4]))
worksheet.write(6, 3, str(Y4miner[5]))
worksheet.write(7, 3, str(Y4miner[6]))
worksheet.write(8, 3, str(Y4miner[7]))
worksheet.write(9, 3, str(Y4miner[8]))
worksheet.write(10, 3, str(Y4miner[9]))
worksheet.write(11, 3, str(Y4miner[10]))

print(Y4miner)
plt.plot(X, Y1miner, '^-', label="DQN policy", zorder=10)
plt.plot(X, Y2miner, 'o-', label="Random policy", zorder=10)
plt.plot(X, Y3miner, '*-', label="HTT policy", zorder=10)
plt.plot(X, Y4miner, '+-', label="Backscatter policy", zorder=10)


plt.xlabel('Hashrate')
plt.legend()
plt.show()
workbook.close()